<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAFECOAST - West African Coastal Flood Early Warning System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #007bff;
            --secondary: #6c757d;
            --success: #28a745;
            --info: #17a2b8;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #00204A; /* Custom dark color */
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--dark);
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 28px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 14px;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            max-height: 70px; /* defines navbar height */
        }
        
        .logo {
            display: flex;
            align-items: center;
            height: 100%;
        }
        /* Logo image adapts to navbar height */
        .logo-img {
            height: 70px;        /* default logo height */
            max-height: 100%;    /* never exceed navbar height */
            width: auto;         /* preserve aspect ratio */
            display: block;
            object-fit: contain;
        }
        
        .logo h1 {
            font-size: 24px;
            margin: 0;
            color: var(--primary);
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 30px;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 600;
            transition: color 0.3s ease;
            font-size: 16px;
        }
        
        .nav-links a:hover {
            color: var(--secondary);
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 39, 74, 0.8), rgba(0, 39, 74, 0.8)), url('https://images.unsplash.com/photo-1561484930-974554019ade?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80') no-repeat center center/cover;
            height: 60vh;
            display: flex;
            align-items: center;
            text-align: center;
            color: white;
            padding-top: 80px;
        }
        
        .hero-content {
            /*max-width: 800px;*/
            margin: 0 auto;
            /*padding: 0 20px;*/
            width: 100%;
            padding: 0 5vw;
        }
        
        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            color: white;
            line-height: 1.2;
        }
        
        .hero p {
            max-width: 850px;
            font-size: 1.2rem;
            margin: 0 auto 30px;
        }
        
        .hero-btns {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* Section Styling */
        section {
            padding: 60px 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .section-title h2 {
            font-size: 2.5rem;
            position: relative;
            display: inline-block;
            padding-bottom: 15px;
        }
        
        .section-title h2:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--primary);
            border-radius: 2px;
        }
        
        /* Problem Section */
        .problem {
            background-color: white;
        }
        
        .problem-content {
            display: flex;
            align-items: center;
            gap: 50px;
            justify-content: flex-start;
        }
        
        .problem-text {
            flex: 2;
            text-align: justify;
        }
        
        .problem-text p {
            margin-bottom: 1.2em;
        }
        
        .problem-image {
            flex: 1;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .problem-image img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            text-align: justify;
        }
        
        .stat-item {
            padding: 20px;
            max-width: 250px;    
            flex: 1;
        }
        
        .stat-item h3 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 10px;
            white-space: normal;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .stat-value {
            display: inline-block;
            min-width: 60px;
        }
        
        .stat-unit {
            margin-left: 4px;
            font-size: 1.5rem;
        }
        
        /* Solution Section */
        .solution {
            background: linear-gradient(to bottom, var(--light), #e6f7ff);
        }
        
        .solution-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .card-icon {
            background: var(--primary);
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
        }
        
        .card-content {
            padding: 30px;
            justify-content: justify;
        }
        
        .card-content h3 {
            margin-bottom: 15px;
            color: var(--primary);
            justify-content: center;
        }
        
        /* System Overview */
        .system-overview {
            background-color: white;
        }
        
        .system-diagram {
            max-width: 100%;
            margin: 0 auto;
            background: url('https://unsplash.com/fr/photos/ecran-de-surveillance-active-qwtCeJ5cLYs') no-repeat center center/cover;
            min-height: 500px;
            height:auto;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            box-sizing: border-box;
        }
        
        .system-diagram::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 87, 146, 0.8);
            border-radius: 8px;
            z-index: 0;
        }
        
        .diagram-content {
            position: relative;
            z-index: 2;
            color: white;
            text-align: justify;
            padding: 30px;
            max-width: 100%;  
            width: 90%;      
        }

        .diagram-content > h3 {
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .diagram-text p {
            position: relative;
            margin-bottom: 1.5em;
            padding-left: 30px; 
            line-height: 1.5;
            width: 100%;
            box-sizing: border-box;
        }

        .diagram-text p::before {
            content: "✔️"; 
            position: absolute;
            left: 0;
            top: 0;
            color: green; 
            font-size: 1.2rem;
            line-height: 1.5;
        }
        
        /* Partners Section */
        .partners {
            background: var(--dark);
            color: white;
        }
        
        .partners .section-title h2 {
            color: white;
        }
        
        .partner-logos {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 40px;
            margin-top: 50px;
        }
        
        .partner-logo {
            height: 80px;
            width: 160px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* CTA Section */
        .cta {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            text-align: center;
            padding: 80px 0;
        }
        
        .cta h2 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .cta p {
            max-width: 700px;
            margin: 0 auto 30px;
            font-size: 1.1rem;
        }
        
        /* Contact Form Styles */
        .contact-section {
            background: white;
            padding: 100px 0;
        }
        
        .contact-container {
            display: flex;
            gap: 40px;
        }
        
        .contact-info {
            flex: 1;
            background: var(--light);
            padding: 40px;
            border-radius: 8px;
        }
        
        .contact-form {
            flex: 1;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }
        
        .contact-form h3 {
            margin-bottom: 25px;
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Open Sans', sans-serif;
            font-size: 16px;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(0, 187, 240, 0.2);
        }
        
        .contact-methods {
            margin-top: 30px;
        }
        
        .contact-method {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .contact-icon {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .contact-details h4 {
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        /* Footer */
        footer {
            background: var(--dark);
            color: rgba(255, 255, 255, 0.7);
            padding: 60px 0 30px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-column h3 {
            color: white;
            margin-bottom: 25px;
            font-size: 1.3rem;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .social-links a:hover {
            background: var(--secondary);
            transform: translateY(-3px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .contact-container {
                flex-direction: column;
            }
            .hero h1 {
                font-size: 2.8rem;
            }
            .problem-content {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            .hero h1 {
                font-size: 2.2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .stats {
                flex-direction: column;
            }
            .hero-btns {
                flex-direction: column;
                align-items: center;
            }
        }
        @media (max-width: 768px) {
            .logo-img {
                height: 32px;
            }
        }

        /* ---------------------------------------------------- */
        /* DASHBOARD SPECIFIC STYLES */
        /* ---------------------------------------------------- */
        /* Removes the large top padding specifically for the dashboard section */
        #dashboard-live {
            padding-top: 10px;
        }

        /*Tights the bottom of the section above the map even further */
        #system {
            padding-bottom: 10px; 
        }

        #map {
            height: 100%;
            width: 100%;
            z-index: 10;
            min-height: 500px;
        }
        .scroller::-webkit-scrollbar {
            width: 6px;
        }
        .scroller::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
        }
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }
        .pulse-severe {
            animation: pulse-red 2s infinite;
        }
        .leaflet-popup-content-wrapper {
            border-radius: 0.50rem;
            padding: 0;
            overflow: hidden;
        }
        .leaflet-popup-content {
            margin: 0;
            padding: 0.5rem;
        }
        .chart-popup-container {
            width: 400px;
            height: 260px;
            padding-bottom: 15px;
        }
        
        .leaflet-bottom.leaflet-left {
            width: 100%;
            left: 0 !important; 
            display: flex;
            justify-content: left;
            align-items: flex-end; 
            padding: 0 10px 10px 10px; 
            box-sizing: border-box;
        }

        .forecast-slider-control {
            background: transparent;
            padding: 4px 8px;
            box-shadow: none;
            border: none; 
            border-radius: 0.5rem;
            width: 95%; 
            max-width: 500px;
        }

        .forecast-slider-control h4 {
            color: #f8fafc !important; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
            font-weight: 700;
            margin-bottom: 4px; 
        }
        
        .slider-container {
            position: relative;
            margin-top: 2px;
        }
        .date-labels-container {
            display: flex;
            justify-content: space-between;
            width: calc(100% - 8px); 
            margin-left: 8px; 
            margin-top: 6px;
        }
        .date-label {
            position: relative;
            text-align: center;
            flex-grow: 1;
            font-size: 0.65rem; 
            color: #f8fafc !important;  
            font-weight: 500;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
            transition: color 0.2s;
            line-height: 1;
        }
        .date-label.active {
            color: #ffffff !important;
            font-weight: 700;
            text-shadow: 0 0 6px rgba(255,255,255,0.9);
        }
        
        #day-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 5px;
            background: rgba(255,255,255,0.25); /* faint white line */
            border-radius: 2px;
        }
        #day-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(0,0,0,0.4);
            cursor: pointer;
            margin-top: -2px; 
            box-shadow: transparent;
        }
        #day-slider::-moz-range-thumb {
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(0,0,0,0.4);
            box-shadow: 0 0 8px rgba(255,255,255,0.8);
        }

    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="#dashboard-live" class="logo" style="text-decoration: none; color: inherit;">
                    <img src="/assets/new_safecoast_logo1.svg" alt=" Safecoast Logo" class="logo-img">
                    <h1 class="ms-2 font-semibold"> SAFECOAST</h1>
                </a>
                <ul class="nav-links">
                    <li><a href="#problem">Challenge</a></li>
                    <li><a href="#solution">Solution</a></li>
                    <li><a href="#dashboard-live">Overview</a></li>
                    <li><a href="#partners">Partners</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <div class="inline-block px-4 py-1 mb-4 text-xs font-bold tracking-widest text-blue-400 uppercase bg-blue-900/50 rounded-full">
                Regional Initiative: Senegal to Gabon
            </div>
            <div class="hero-content">
                <h1 class="text-4xl md:text-6xl font-bold mb-6">Turning Earth Observation and Satellite Data into Coastal Resilience Tools</h1>
                <p class="text-xl mb-8 text-slate-200">Empowering West African communities with advanced coastal flood early warning systems to protect lives and livelihoods.</p>
                <div class="hero-btns">
                    <a href="#solution" class="btn">Our Methodology</a>
                    <a href="https://safecoastpro.github.io/" target="_blank" class="btn btn-outline">Explore Live Demonstrator</a>
                </div>
            </div>
        </div>
    </section>

    <section id="problem" class="problem">
        <div class="container">
            <div class="section-title">
                <h2>Data Gap Challenge</h2>
                <p>Bridging the Gap Between Scientific Research and Operational Protection</p>
            </div>
            <div class="problem-content flex flex-col lg:flex-row gap-12 items-start">
                <div class="problem-text flex-[2]">
                    <p class="mb-4">
                        The <strong>West African</strong> coast, stretching from Senegal to Gabon, is among the regions most exposed to the impacts of climate change. Sea-level rise, intensifying storms, and increasingly frequent extreme weather events are accelerating coastal flooding and erosion across the region.
                    </p>
                    <p class="mb-4">
                        The consequences are already severe : in 2017 alone,  Benin, Côte d’Ivoire, Senegal and Togo suffered an estimated <strong>$3.8 billion in damages</strong> (5.3% of their combined GDP). Coastal hazards have been linked to over 13,000 deaths, and this figure continues to rise. Rapid urbanisation, population growth in low-lying areas and environmental degradation are amplifying exposure and weakening coastal resilience, resulting in more frequent and destructive flooding.
                    </p>
                    <p class="mb-4">
                        Yet despite growing risks, most countries still lack <strong>operational early warning systems and reliable, continuous local data to anticipate and respond to disasters</strong>. While the scientific community has greatly improved our understanding of coastal dynamics through the work of international programmes and initiatives (<strong>IRD, LEGOS and others</strong>), a critical <strong>'Data Gap'</strong> persists.
                    </p>
                    <p class="mb-4">
                        Currently, there is an almost total absence of operational regional early warning systems based on reliable, continuous data. In-situ sensors are scarce, rare if not non-existent, depriving local authorities of tools to support informed decision-making.
                    </p>

                    <p class="mb-4">
                        This critical gap undermines climate adaptation, disaster risk reduction, and progress towards the Sustainable Development Goals, especially <strong>SDG 11 (Resilient Cities), SDG 13 (Climate Action), and SDG 14 (Life Below Water)</strong>.
                    </p>
                    <div class="bg-blue-50 border-l-4 border-blue-600 p-6 my-8 rounded-r-xl">
                        <p class="text-2xl italic text-blue-900 font-medium">
                            "Without the ability to measure and forecast, we cannot predict and protect. SAFECOAST addresses this critical operational gap by transforming earth observations data into early warning systems, and science into coastal resilience."
                        </p>
                    </div>

                    <div class="stats grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="stat-item text-center">
                            <h3 class="text-3xl font-bold text-blue-600">
                                <span class="stat-unit">~</span><span class="stat-value" data-target="105">0</span><span class="stat-unit">M</span>
                            </h3>
                            <p class="text-sm">People at risk in low-lying areas across West Africa.</p>
                        </div>
                        <div class="stat-item text-center">
                            <h3 class="text-3xl font-bold text-blue-600">
                                <span class="stat-unit">$</span><span class="stat-value" data-target="3.8">0</span><span class="stat-unit">B</span>
                            </h3>
                            <p class="text-sm">Economic damages in 2017 alone for Benin, Côte d'Ivoire, Senegal, and Togo.</p>
                        </div>
                        <div class="stat-item text-center">
                            <h3 class="text-3xl font-bold text-blue-600">
                                <span class="stat-value" data-target="13000">0</span>
                            </h3>
                            <p class="text-sm">Lives lost to coastal hazards in the region during the 2017 period.</p>
                        </div>
                    </div>
                </div>
                <div class="problem-image flex-1 w-full max-w-md mx-auto">
                    <div class="bg-blue-50 p-8 rounded-2xl border border-blue-100 flex flex-col items-center justify-center text-center shadow-inner">
                        <img
                        src="/assets/world_tidegauge.svg"
                        alt="World Tide Gauge Stations"
                        class="h-8 sm:h-9 md:h-10 w-auto object-contain"
                        loading="lazy"
                        />
                        <h4 class="font-bold text-slate-800 mb-2">The Data Gap</h4>
                        <p class="text-sm text-slate-600 italic text-justify">"Fragmented data prevents effective decision-making. We transform Earth Observation & satellites data into a shield for coastal communities."</p>
                    </div>

                    <div class="mt-6">
                    <p class="text-xs uppercase tracking-wide text-slate-900 mb-3">
                        Contributing to the Sustainable Development Goals
                    </p>
                    <div class="flex justify-center gap-4">
                        <div class="flex flex-col items-center">
                            <img
                                src="/assets/E_WEB_11.png"
                                alt="SDG 11 – Sustainable Cities and Communities"
                                class="w-16 h-auto rounded"
                                loading="lazy"
                            />
                            <span class="text-xs font-semibold mt-1">SDG 11</span>
                        </div>

                        <div class="flex flex-col items-center">
                            <img
                                src="/assets/E_WEB_13.png"
                                alt="SDG 13 – Climate Action"
                                class="w-16 h-auto rounded"
                                loading="lazy"
                            />
                            <span class="text-xs font-semibold mt-1">SDG 13</span>
                        </div>

                        <div class="flex flex-col items-center">
                            <img
                                src="/assets/E_WEB_14.png"
                                alt="SDG 14 – Life Below Water"
                                class="w-16 h-auto rounded"
                                loading="lazy"
                            />
                            <span class="text-xs font-semibold mt-1">SDG 14</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="solution" class="solution">
        <div class="container">
            <div class="section-title">
                <h2>Our Solution & Advantage</h2>
                <p>We leverage a state-of-the-art technical stack to bridge the data gap and foster West Africa regional coastal resilience.</p>
            </div>
            
            <div class="solution-cards">
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-satellite-dish"></i>
                    </div>
                    <div class="card-content">
                        <h3>Earth Observation & satellites</h3>
                        <p class="text-justify">We integrate satellite data, numerical models, and in-situ observations with Copernicus marine hindcasts and tidal models to estimate Total Water Level (TWL) along the coast. This enables robust analysis of extreme events and supports threshold-based early warning, transforming Earth observation data into actionable coastal risk intelligence.</p>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="card-content">
                        <h3> Predictive Intelligence</h3>
                        <p class="text-justify">Machine learning models analyze historical hydrodynamic and atmospheric data to produce probabilistic forecasts of extreme coastal events. This predictive intelligence improves early warning accuracy and lead time across the Gulf of Guinea, supporting proactive risk reduction and climate adaptation.</p>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="card-content">
                        <h3>Multi-Channel Alerts</h3>
                        <p class="text-justify"> Prioritizing accessibility and redundancy multi-channel communication, alerts translate into timely action, supporting last-mile delivery and strengthening community-level disaster preparedness.</p>
                    </div>
                </div>
            </div>
            <div class="container text-center">
                <div class="bg-blue-50 border-l-8 border-blue-600 p-10 my-8 rounded-r-xl">
                    <p class="text-2xl text-blue-900 font-bold">
                        SAFECOAST is committed to a long-term vision that extends beyond data provision. Our sustainable service model ensures ongoing platform optimisation and capacity building, relieving local partners from technical complexities.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="p-8 border border-slate-100 rounded-2xl bg-slate-50">
                        <i class="fas fa-check-circle text-green-500 mb-4 fa-2x"></i>
                        <h3 class="font-bold mb-2">Cost Optimization</h3>
                        <p class="text-sm text-slate-500">Shared infrastructure costs across the region, making high-tech warnings affordable for local municipalities and agencies.</p>
                    </div>
                    <div class="p-8 border border-slate-100 rounded-2xl bg-slate-50">
                        <i class="fas fa-user-graduate text-blue-500 mb-4 fa-2x"></i>
                        <h3 class="font-bold mb-2">User Autonomy</h3>
                        <p class="text-sm text-slate-500">We focus on transferring decision-making skills. Our partners become fully autonomous in risk management, not tech support.</p>
                    </div>
                    <div class="p-8 border border-slate-100 rounded-2xl bg-slate-50">
                        <i class="fas fa-sync text-orange-500 mb-4 fa-2x"></i>
                        <h3 class="font-bold mb-2">Continuous Improvement</h3>
                        <p class="text-sm text-slate-500">Centralized maintenance by SAFECOAST experts ensures the system evolves with the latest AI and satellite breakthroughs.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="dashboard-live" class="system-overview">
        <div id="safecoast-interface" class="w-full mx-auto p-4 space-y-6">
            <div class="flex flex-col md:flex-row justify-between items-center bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900">West African Coastal Flooding Forecast System</h2>
                </div>
                
                <div class="mt-4 md:mt-0 flex flex-wrap gap-2">
                    <div class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-bold border border-green-200 flex items-center">
                        <span class="w-2 h-2 bg-[#28a745] rounded-full mr-2"></span> No Flood
                    </div>
                    <div class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-bold border border-yellow-200 flex items-center">
                        <span class="w-2 h-2 bg-[#ffc107] rounded-full mr-2"></span> Warning
                    </div>
                    <div class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-bold border border-orange-200 flex items-center">
                        <span class="w-2 h-2 bg-[#fd7e14] rounded-full mr-2"></span> High Risk
                    </div>
                    <div class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-bold border border-red-200 flex items-center">
                        <span class="w-2 h-2 bg-[#dc3545] rounded-full mr-2"></span> Severe Flood
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-auto lg:h-[500px]">
                
                <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden relative h-[500px] lg:h-full flex flex-col">
                    <div class="p-4 border-b border-slate-100 flex justify-between items-center shrink-0">
                        <h3 class="font-semibold text-slate-700">Region Status Map</h3>
                        <span class="text-xs text-slate-400" id="current-date-display">Live Data</span>
                    </div>
                    <div class="flex-1 relative">
                        <div id="map"></div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-[500px] lg:h-full">
                    <div class="p-4 border-b border-slate-100 bg-slate-50 rounded-t-xl shrink-0">
                        <h3 class="font-semibold text-slate-700">Location Details</h3>
                        <p class="text-xs text-slate-500" id="location-subtitle">Click map for 24h forecast & details</p>
                    </div>
                    
                    <div class="p-4 flex-1 overflow-y-auto scroller space-y-5">
                        
                        <div>
                            <h4 class="text-sm font-semibold text-slate-700 mb-3 border-b pb-2 flex justify-between items-center">
                                <span>Daily Forecast Summary</span>
                                <span class="text-xs font-normal text-slate-500" id="day-label-summary">Today's Forecast</span>
                            </h4>

                            <div class="grid grid-cols-3 gap-3">
                                
                                <div class="bg-blue-50 p-3 rounded-lg border border-blue-200">
                                    <div class="text-xs text-blue-700 mb-1 font-medium">Site Name</div>
                                    <div class="text-base font-bold text-blue-900 truncate" id="stat-site-name">Select Region</div>
                                </div>
                                
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-200">
                                    <div class="text-xs text-slate-500 mb-1">Current Max TWL</div>
                                    <div class="text-base font-bold text-blue-900" id="stat-twl">-- m</div>
                                </div>
                                
                                <div class="bg-slate-50 p-3 rounded-lg border border-slate-200">
                                    <div class="text-xs text-slate-500 mb-1">Current Risk Status</div>
                                    <div class="text-base font-bold" id="stat-risk">--</div> 
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-sm font-semibold text-slate-700 mb-2 mt-4 border-b pb-2">7-Day Forecast Horizon</h4>
                            <div class="overflow-x-auto rounded-lg border border-slate-100">
                                <table class="w-full text-sm text-left">
                                    <thead class="text-xs text-slate-500 bg-slate-50 uppercase">
                                        <tr>
                                            <th class="px-2 py-2">Date</th>
                                            <th class="px-2 py-2">Max TWL</th>
                                            <th class="px-2 py-2">Risk</th>
                                        </tr>
                                    </thead>
                                    <tbody id="forecast-table-body" class="text-slate-600 bg-white">
                                        <tr>
                                            <td colspan="3" class="text-center py-4 text-slate-400 italic">Select a location...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <script>
        // ---------------------------
        // 1. CONFIGURATION
        // ---------------------------
        
        /**
         * Configuration for file paths.
         * Adjust 'DATA_BASE_PATH' if your JSON and CSV files are in a subdirectory (e.g., './data/').
         */
        const CONFIG = {
            DATA_BASE_PATH: './data/', // Current directory. Change to './data/' if files are in a data folder.
            SITES_FILENAME: 'sites_file.json'
        };

        const RISK_COLORS = {
            "No Flood": "#28a745",    // Green
            "Warning": "#ffc107",     // Yellow
            "High Risk": "#fd7e14",   // Orange
            "Severe Flood": "#dc3545" // Red
        };

        // --- DYNAMIC DATE GENERATION ---
        /**
         * Returns the current date formatted as YYYYMMDD.
         * Example: If today is Dec 1, 2025, returns "20251201".
         */
        function getTodayDateFormatted() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        // Set the FORECAST_DATE_STRING dynamically
        const FORECAST_DATE_STRING = getTodayDateFormatted();
        
        console.log("System initialized for forecast date:", FORECAST_DATE_STRING);

        const NUM_DAYS = 7;
        const TIME_INTERVAL_MINUTES = 10; 
        const DATA_POINTS_PER_HOUR = 60 / TIME_INTERVAL_MINUTES; 
        const DATA_POINTS_PER_DAY = 24 * DATA_POINTS_PER_HOUR; 

        // ---------------------------
        // 2. GLOBAL STATE
        // ---------------------------
        let map;
        let currentDayIndex = 0; // 0 for Today, 6 for Day 7
        let currentSiteData = null; // Data for the currently selected site
        let mapMarkers = []; 
        let SITES = []; 

        // ---------------------------
        // 3. UTILITY FUNCTIONS
        // ---------------------------

        function classifyRisk(twl, thresh, risk_classes) {
            if (twl < thresh) return "No Flood";
            if (twl < risk_classes[0]) return "Warning";
            if (twl < risk_classes[1]) return "High Risk";
            return "Severe Flood";
        }

        /**
         * Returns the full date string for display (e.g., "Friday, Nov 29")
         * Based on the dynamically generated FORECAST_DATE_STRING
         */
        function getForecastDate(dayIndex) {
            const year = parseInt(FORECAST_DATE_STRING.substring(0, 4));
            const month = parseInt(FORECAST_DATE_STRING.substring(4, 6)) - 1; 
            const day = parseInt(FORECAST_DATE_STRING.substring(6, 8));
            
            const startDate = new Date(year, month, day);
            const forecastDate = new Date(startDate);
            forecastDate.setDate(startDate.getDate() + dayIndex);
            
            return forecastDate.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' }); 
        }

        /**
         * Parses CSV to include ALL hourly data points, stores Max TWL time, and full Date object.
         */
        function parseForecastCSV(csvText, site) {
            const lines = csvText.trim().split('\n');
            if (lines.length < 2) return { daily: [], hourly: [] };

            const header = lines[0].split(',');
            // Case-insensitive search for 'total_water_level'
            const twlColumnIndex = header.findIndex(h => h.trim().toLowerCase() === 'total_water_level'); 
            
            if (twlColumnIndex === -1) {
                console.error(`TWL column not found in CSV header for ${site.id}.`);
                return { daily: [], hourly: [] };
            }
            
            const dataRows = lines.slice(1);
            const rawTWLData = [];

            dataRows.forEach(line => {
                const cols = line.split(',');
                if (cols.length > twlColumnIndex) {
                    const timestamp = cols[0];
                    const twl = parseFloat(cols[twlColumnIndex]);
                    if (!isNaN(twl)) {
                        rawTWLData.push({ timestamp: timestamp, twl: twl });
                    }
                }
            });

            // 1. Prepare Daily Summary (7 days)
            const dailyData = [];
            const dateToday = new Date(
                    parseInt(FORECAST_DATE_STRING.substring(0, 4)), 
                    parseInt(FORECAST_DATE_STRING.substring(4, 6)) - 1, 
                    parseInt(FORECAST_DATE_STRING.substring(6, 8))
                );
            for (let i = 0; i < NUM_DAYS; i++) {
                const startIdx = i * DATA_POINTS_PER_DAY;
                const endIdx = startIdx + DATA_POINTS_PER_DAY;
                const dayTWLData = rawTWLData.slice(startIdx, endIdx);

                if (dayTWLData.length === 0) break; 

                const max_twl = dayTWLData.reduce((max, item) => Math.max(max, item.twl), 0);
                const risk = classifyRisk(max_twl, site.threshold, site.risk_class);
                
                // Calculate date based on dynamic forecast start date
                const fullDate = getForecastDate(i);
                const dateObj = new Date(
                    parseInt(FORECAST_DATE_STRING.substring(0, 4)), 
                    parseInt(FORECAST_DATE_STRING.substring(4, 6)) - 1, 
                    parseInt(FORECAST_DATE_STRING.substring(6, 8))
                );
                dateObj.setDate(dateObj.getDate() + i);

                dailyData.push({
                    date: dateObj.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' }),
                    fullDate: fullDate, 
                    max_water_level: parseFloat(max_twl.toFixed(3)),
                    risk: risk
                });
            }

            // 2. Prepare Hourly Data (Capture ALL 7 days of hourly points)
            // We filter raw data (10-min) to get hourly points (every 6th point)
            const fullHourlyData = rawTWLData
                .filter((_, index) => index % DATA_POINTS_PER_HOUR === 0)
                .map(item => parseFloat(item.twl.toFixed(3)));

            return { daily: dailyData, hourly: fullHourlyData };
        }


        // ---------------------------------------
        // 4. MAP INIT & CUSTOM CONTROL
        // ---------------------------------------
        let ForecastSliderControl;

        function initializeMap() {
            map = L.map('map').setView([5.0, 2.0], 6); 
            L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri'
            }).addTo(map);
            L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",{ 
                attribution: "© Esri", maxZoom: 19 
            }).addTo(map);

            ForecastSliderControl = L.Control.extend({
                onAdd: function(map) {
                    const container = L.DomUtil.create('div', 'leaflet-bar forecast-slider-control');
                    container.innerHTML = `
                        <h4 class="text-sm font-semibold text-slate-700 mb-3 text-center">Forecast Day Selector</h4>
                        <div class="slider-container">
                            <input type="range" min="0" max="6" value="0" id="day-slider" oninput="handleDaySelection(this.value)">
                            <div class="date-labels-container" id="date-labels-container"></div>
                        </div>
                    `;
                    L.DomEvent.disableClickPropagation(container);
                    L.DomEvent.disableScrollPropagation(container);
                    return container;
                },
                onRemove: function(map) {}
            });
            new ForecastSliderControl({ position: 'bottomleft' }).addTo(map);
        }

        // ---------------------------
        // 5. CORE DASHBOARD LOGIC
        // ---------------------------

        function renderMapMarkers(dayIndex) {
            mapMarkers.forEach(marker => {
                const site = marker.options.site;
                if (!site.forecastData || site.forecastData.daily.length === 0) return; 

                const dayForecast = site.forecastData.daily[dayIndex];
                const risk = dayForecast ? dayForecast.risk : 'No Data';
                const color = RISK_COLORS[risk] || '#6c757d'; 
                const isSevere = risk === "Severe Flood";
                
                const markerHtml = `
                    <div class="${isSevere ? 'pulse-severe' : ''}" style="
                        background-color: ${color};
                        width: 25px;
                        height: 25px;
                        border-radius: 50%;
                        border: 1px solid white;
                        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4);
                    "></div>
                `;

                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: markerHtml,
                    iconSize: [18, 18],
                    iconAnchor: [9, 9]
                });

                marker.setIcon(icon);
            });
        }

        function updateSidebar(site) {
            currentSiteData = site.forecastData;
            
            if (!currentSiteData || currentSiteData.daily.length === 0) {
                document.getElementById('stat-site-name').innerText = site.name;
                document.getElementById('day-label-summary').innerText = "No Forecast Data";
                document.getElementById('stat-twl').innerText = "-- m";
                const riskEl = document.getElementById('stat-risk');
                riskEl.innerText = "N/A";
                riskEl.style.color = '#6c757d';
                document.getElementById('forecast-table-body').innerHTML = `<tr><td colspan="3" class="text-center py-4 text-slate-400 italic">Data not available for ${site.name}</td></tr>`;
                return;
            }

            const selectedDayStatus = currentSiteData.daily[currentDayIndex];

            // Safety check if we scrolled past available data days
            if (!selectedDayStatus) return;

            document.getElementById('location-subtitle').innerText = `Site Threshold: ${site.threshold}m`;
            document.getElementById('stat-site-name').innerText = site.name;
            document.getElementById('day-label-summary').innerText = selectedDayStatus.fullDate; 
            document.getElementById('stat-twl').innerText = `${selectedDayStatus.max_water_level} m`;
            
            const riskEl = document.getElementById('stat-risk');
            riskEl.innerText = selectedDayStatus.risk;
            riskEl.style.color = RISK_COLORS[selectedDayStatus.risk];

            const tableBody = document.getElementById('forecast-table-body');
            tableBody.innerHTML = '';
            
            currentSiteData.daily.forEach((day, index) => {
                const colorCode = RISK_COLORS[day.risk];
                const badge = `<span class="px-2 py-0.5 rounded text-[10px] font-bold text-white uppercase tracking-wider" style="background-color: ${colorCode}">${day.risk}</span>`;
                const isSelected = index === currentDayIndex ? 'bg-blue-50 border-blue-200' : 'hover:bg-slate-50';
                
                let dateCellText;
                if (index === 0) {
                    dateCellText = `Today (${day.date})`;
                } else {
                    dateCellText = day.date;
                }

                const row = `
                    <tr class="border-b border-slate-50 last:border-0 transition ${isSelected}">
                        <td class="px-2 py-2 font-medium text-slate-700">${dateCellText}</td>
                        <td class="px-2 py-2 text-slate-600">${day.max_water_level} m</td>
                        <td class="px-2 py-2">${badge}</td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        function showChartPopup(site, marker) {
            const data = site.forecastData; 
            
            if (!data || data.hourly.length === 0) {
                L.popup()
                    .setLatLng(marker.getLatLng())
                    .setContent(`<div class="p-2 text-center text-red-600 font-semibold">Hourly chart data not available.</div>`)
                    .openOn(map);
                return;
            }
            
            map.closePopup();

            // --- NEW LOGIC START ---
            // Calculate the start and end index for the selected day (24 hours * currentDayIndex)
            const startHour = currentDayIndex * 24;
            const endHour = startHour + 24;
            
            // Slice only the 24 hours relevant to the selected day
            // If we are at the end of the array and don't have full 24h, it just takes what's left
            const daysHourlyData = data.hourly.slice(startHour, endHour);
            const displayDate = getForecastDate(currentDayIndex);
            // --- NEW LOGIC END ---

            const chartHtml = `
                <div class="chart-popup-container">
                    <h5 class="text-sm font-semibold text-slate-700 text-center mb-1">
                        ${site.name}<br>
                        <span class="text-xs text-slate-500 font-normal">${displayDate}</span>
                    </h5>
                    <canvas id="popupChartCanvas"></canvas>
                </div>
            `;
            
            const popup = L.popup({ 
                closeButton: true, 
                minWidth: 420, 
                maxWidth: 420,
                autoClose: true,
                className: 'water-level-popup'
            })
            .setLatLng(marker.getLatLng())
            .setContent(chartHtml)
            .openOn(map);
            
            popup.on('remove', () => {
                const canvas = document.getElementById('popupChartCanvas');
                if (canvas) canvas.remove();
            });

            setTimeout(() => {
                const ctx = document.getElementById('popupChartCanvas');
                if (!ctx) return; 

                new Chart(ctx.getContext('2d'), {
                    type: 'line',
                    data: {
                        // Labels 0h to 23h
                        labels: Array.from({length: daysHourlyData.length}, (_, i) => i % 4 === 0 ? `${i}h` : ''), 
                        datasets: [{
                            label: 'Total Water Level (m)',
                            data: daysHourlyData, // Use the sliced data
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 0, 
                        }, {
                            label: 'Threshold',
                            // Match the length of the sliced data
                            data: Array(daysHourlyData.length).fill(site.threshold),
                            borderColor: '#fd7e14',
                            borderWidth: 1.5,
                            borderDash: [4, 4],
                            pointRadius: 0,
                            fill: false
                        }]
                    },

                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { 
                            legend: { display: false },
                            tooltip: { mode: 'index', intersect: false }
                        },
                        scales: { 
                            y: { 
                                ticks: { font: { size: 10 } },
                                title: {
                                    display: true,
                                    text: 'Water Level (m)',
                                    font: { size: 12, weight: 'bold' }
                                }
                            }, 
                            x: { 
                                ticks: { font: { size: 10 } },
                                title: {
                                    display: true,
                                    text: 'Time (Hours)',
                                    font: { size: 12, weight: 'bold' }
                                }
                            } 
                        },
                        interaction: { mode: 'nearest', axis: 'x', intersect: false }
                    }
                });
            }, 50); 
        }

        // ---------------------------
        // 6. INTERACTION HANDLERS
        // ---------------------------

        function updateDateLabels(dayIndex) {
            const container = document.getElementById('date-labels-container');
            if (!container) return;
            
            container.innerHTML = '';
            const stepWidth = 100 / 6; 

            for (let i = 0; i < NUM_DAYS; i++) {
                const dateText = getForecastDate(i);
                const dayLabel = i === 0 ? "Today" : dateText.split(',')[1].trim(); 
                const isActive = i === dayIndex;
                let leftPosition = i * stepWidth;
                if (i === 6) leftPosition = 100; 
                
                const label = document.createElement('div');
                label.className = `date-label absolute ${isActive ? 'active' : ''}`;
                label.style.transform = `translateX(-50%)`; 
                label.style.left = `${leftPosition}%`;
                label.textContent = dayLabel;

                label.onclick = () => {
                    document.getElementById('day-slider').value = i;
                    handleDaySelection(i);
                };
                container.appendChild(label);
            }
        }

        function handleDaySelection(value) {
            currentDayIndex = parseInt(value, 10);
            renderMapMarkers(currentDayIndex);
            
            if (currentSiteData) {
                const selectedSite = SITES.find(s => s.forecastData === currentSiteData);
                if (selectedSite) updateSidebar(selectedSite);
            } else if (SITES.length > 0) {
                updateSidebar(SITES[0]);
            }

            updateDateLabels(currentDayIndex);
            map.closePopup();
        }

        // ---------------------------
        // 7. EXTERNAL DATA FETCHING
        // ---------------------------

        function transformRawSites(rawData) {
            return Object.entries(rawData).map(([id, data]) => {
                const formattedName = id.replace(/-/g, ' ').toLowerCase().split(' ')
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(' ');

                return {
                    id: id,
                    name: `${formattedName} (${data.city})`,
                    lat: data.lat_cible, 
                    lng: data.lon_cible, 
                    threshold: data.threshold,
                    risk_class: data.risk_class,
                    forecastData: null
                };
            });
        }
        
        /**
         * Fetches and parses the forecast CSV for a single site using the standard Fetch API.
         * Expects files to be at: CONFIG.DATA_BASE_PATH + all_twl_data_{SITE}_{DATE}.csv
         */
        async function fetchAndParseForecast(site) {
            const filename = `${CONFIG.DATA_BASE_PATH}all_twl_data_${site.id}_${FORECAST_DATE_STRING}.csv`;
            
            try {
                const response = await fetch(filename);
                
                if (!response.ok) {
                    console.warn(`Forecast file not found for ${site.name} (${filename}). Status: ${response.status}`);
                    return { ...site, forecastData: { daily: [], hourly: [] } };
                }

                const csvText = await response.text();
                const forecastData = parseForecastCSV(csvText, site);
                
                return { ...site, forecastData: forecastData };

            } catch (error) {
                console.error(`Network error fetching forecast for ${site.name}:`, error);
                return { ...site, forecastData: { daily: [], hourly: [] } };
            }
        }

        /**
         * Main entry point.
         */
        async function loadSitesDataAndInit() {
            try {
                const sitesUrl = CONFIG.DATA_BASE_PATH + CONFIG.SITES_FILENAME;
                console.log(`Fetching sites configuration from: ${sitesUrl}`);
                
                const sitesResponse = await fetch(sitesUrl);
                if (!sitesResponse.ok) {
                     throw new Error(`Failed to load ${CONFIG.SITES_FILENAME} (${sitesResponse.status})`);
                }

                const rawSitesData = await sitesResponse.json();
                let tempSites = transformRawSites(rawSitesData);
                
                // Concurrently fetch forecast data for all sites
                const fetchPromises = tempSites.map(site => fetchAndParseForecast(site));
                const results = await Promise.all(fetchPromises);
                
                // We filter only sites that have valid data, OR keep them all but show "No Data" in UI
                // Keeping all sites ensures markers appear even if today's forecast is missing.
                SITES = results;
                
                if (SITES.length > 0) {
                    initApp();
                } else {
                    throw new Error("No sites loaded.");
                }

            } catch (error) {
                console.error("Fatal error during application setup:", error);
                document.getElementById('safecoast-interface').innerHTML = `
                    <div class="max-w-7xl mx-auto p-4 space-y-6">
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative text-center" role="alert">
                            <strong class="font-bold">System Error:</strong> 
                            <span class="block sm:inline">${error.message}. Please ensure '${CONFIG.SITES_FILENAME}' is accessible.</span>
                        </div>
                    </div>
                `;
            }
        }
        
        function initApp() {
            initializeMap();

            SITES.forEach(site => {
                const marker = L.marker([site.lat, site.lng], { site: site }).addTo(map);
                mapMarkers.push(marker); 
                marker.bindTooltip(`<b>${site.name}</b>`, {direction: 'top', offset: [0, -10]});
                
                marker.on('click', () => {
                    updateSidebar(site);
                    map.flyTo([site.lat, site.lng], 8, { duration: 1.0 });
                    showChartPopup(site, marker);
                });
            });

            // Select first site and today's date
            handleDaySelection(0); 
            if (SITES.length > 0) {
                updateSidebar(SITES[0]);
            }

            document.getElementById('current-date-display').innerText = new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
        }

        window.onload = loadSitesDataAndInit;
    </script>
    <section id="partners" class="partners">
        <div class="container">
            <div class="section-title">
                <h2>Our Valued Partners</h2>
            </div>
            <div class="partner-logos">
                <div class="partner-logo">Partner 1</div>
                <div class="partner-logo">Partner 2</div>
                <div class="partner-logo">Partner 3</div>
                <div class="partner-logo">Partner 4</div>
            </div>
        </div>
    </section>

    <section class="cta">
        <div class="container">
            <h2>Join Us in Protecting Coastal Communities</h2>
            <p>Your support is crucial in helping us expand our reach and enhance the resilience of West African coastlines.</p>
            <a href="#contact" class="btn btn-outline">Get Involved Today</a>
        </div>
    </section>

    <section id="contact" class="contact-section">
        <div class="container">
            <div class="section-title">
                <h2>Contact Us</h2>
            </div>
            <div class="contact-container">
                <div class="contact-info">
                    <h3>Get in Touch</h3>
                    <p>Have questions about SAFECOAST, want to collaborate, or need support? Reach out to us!</p>
                    <div class="contact-methods">
                        <div class="contact-method">
                            <div class="contact-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="contact-details">
                                <h4>Phone</h4>
                                <p>+33 (0)7 58 01 11 83</p>
                            </div>
                        </div>
                        
                        <div class="contact-method">
                            <div class="contact-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-details">
                                <h4>Email</h4>
                                <p>safecoastpro@gmail.com</p>
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div class="contact-form">
                    <h3>Send Us a Message</h3>
                    <form name="contact" method="POST" netlify>
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" name="name" id="name" placeholder="Your full name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" name="email" id="email" placeholder="Your email address" required>
                        </div>
                        <div class="form-group">
                            <label for="subject">Subject</label>
                            <input type="text" name="subject" id="subject" placeholder="Message subject">
                        </div>
                        
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea name="message" id="message" rows="5" placeholder="Your message" required style="width: 100%; padding: 12px 15px; border: 1px solid #ddd; border-radius: 4px; font-family: 'Open Sans', sans-serif; font-size: 16px;"></textarea>
                        </div>
                        
                        <button type="submit" class="btn" style="width: 100%;">
                            <i class="fas fa-paper-plane"></i> Send Message
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>SAFECOAST</h3>
                    <p>Empowering West African communities through advanced coastal flooding early warning systems that support climate adaptation and disaster risk reduction.</p>
                    </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#problem">Challenge</a></li>
                        <li><a href="#solution">Solution</a></li>
                        <li><a href="#system">Overview</a></li>
                        <li><a href="#partners">Partners</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Follow Us</h3>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
                </div>
            </div>
            <div class="copyright">
                &copy; 2025 SAFECOAST. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        
        // Fixed statistics animation with units preserved
        const statValues = document.querySelectorAll('.stat-value');
        const observerOptions = {
            threshold: 0.5
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const statValue = entry.target;
                    const targetValue = parseFloat(statValue.dataset.target);
                    const isDecimal = targetValue % 1 !== 0;
                    let currentValue = 0;
                    
                    const increment = targetValue / 50;
                    
                    const interval = setInterval(() => {
                        currentValue += increment;
                        if (currentValue >= targetValue) {
                            statValue.textContent = isDecimal ? targetValue.toFixed(1) : targetValue;
                            clearInterval(interval);
                        } else {
                            statValue.textContent = isDecimal ? currentValue.toFixed(1) : Math.round(currentValue);
                        }
                    }, 30);
                    
                    observer.unobserve(statValue);
                }
            });
        }, observerOptions);
        
        statValues.forEach(stat => {
            observer.observe(stat);
        });
    </script>
</body>
</html>
